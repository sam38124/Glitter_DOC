<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../glitterBundle/ControlInstance.js"></script>
</head>
<style>
    html {
        width: 100%;
        height: 100%;

    }

    body {
        width: 100%;
        height: 100%;
    }

    .topBar {
        width: 100%;
        height: 50px;
        background-color: dodgerblue;
        display: flex;
        align-items: center;
    }

    .flexbox {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .circleSelect.active {
        background-color: orangered;
    }

    .circleSelect {
        border-radius: 18px;
        background-color: white;
        width: 18px;
        height: 18px;
        border-width: 3px;
        border-color: lightgray;
        border-style: solid;
    }

    .circleSelect2.active {
        background-color: orangered;
    }

    .circleSelect2 {
        border-radius: 18px;
        background-color: white;
        width: 18px;
        height: 18px;
        border-width: 3px;
        border-color: lightgray;
        border-style: solid;
    }
    .inSelct3{
        margin-top: 0;
        margin-left: 10px;
        background-color:white;border-radius:10px; display: flex;align-items: center;min-width: 100px;justify-content: center;height: 40px;min-height: 40px;
    }
    .circleSelect3.active {
        background-color: orangered;
    }

    .circleSelect3 {
        border-radius: 18px;
        background-color: white;
        width: 18px;
        height: 18px;
        border-width: 3px;
        border-color: lightgray;
        border-style: solid;
    }
    .inSelct {
        margin-top: 0;
        background-color: white;
        border-radius: 10px;
        display: flex;
        margin-left: 10px;
        align-items: center;
        min-width: 100px;
        justify-content: center;
        height: 40px;
    }

    .inSelct2 {
        margin-top: 0;
        background-color: white;
        border-radius: 10px;
        display: flex;
        align-items: center;
        margin-left: 10px;
        min-width: 100px;
        justify-content: center;
        height: 40px;
    }

    .content {
        width: 100%;
        height: calc(100%);
        display: flex;
        align-items: center;
        overflow-y: scroll;
        flex-direction: column;
    }

    .head {
        min-height: 100px;
        min-width: 100px;
        width: 100px;
        height: 100px;
        border-radius: 50px;
        background-color: whitesmoke;
        margin-top: 23px;
    }

    .smallTitle {
        width: calc(100% - 30px);
        color: black;
        font-size: 15px;
        margin-bottom: 0;
    }

    input {
        min-height: 30px;
        height: 30px;
        color: black;
        font-weight: 400;
        font-size: 15px;
        width: calc(100% - 35px);
        border-color: #aaaaaa;
        border-width: 1px;
        border-style: solid;
        padding-left: 5px;
        border-radius: 2px;
        margin-top: 10px;
    }

    .hint {
        color: #8e8e8e;
        font-size: 13px;
        font-weight: 400;
        width: calc(100% - 30px);
        margin-top: 5px;
    }

    textarea {
        width: calc(100% - 40px);
        height: 60px;
        min-height: 60px;
        margin-top: 5px;
        padding: 5px;
        font-size: 14px;
        border-color: #aaaaaa;
        border-width: 1px;
        border-style: solid;
    }

    .flexSelect {
        height: 30px;
        margin-top: 20px;
        display: flex;
        justify-content: left;
        width: calc(100% - 30px);
        margin-bottom: 10px;
    }

    .selectItem {
        display: flex;
        align-items: center;
        margin-right: 10px;
    }

    .item {
        border-width: 2px;
        border-color: gray;
        border-style: solid;
        border-radius: 50%;
        width: 20px;
        margin-left: 0;
        height: 20px;
    }

    .select {
        background-color: red;
    }

    .selectItem span {
        font-size: 11px;
        margin-left: 5px;
    }

    .checkBox {
        border-width: 2px;
        border-style: solid;
        border-color: dodgerblue;
        margin-left: 0;
        width: 20px;
        background-size: 20px 20px;
        height: 20px;
    }

    .check {
        background-image: url("../img/checkbox_check.png");
    }
</style>
<body>
<script>
    var selectPosition = gBundle.data.manager
    var isPay = (gBundle.data.isPay === "1")
    var userData = gBundle.data
    lifeCycle.onCreate = function () {
        updateSelect(gBundle.data.manager)
        updateSelect2()
        updateSelect3()
    }

    function updateSelect(pos) {
        selectPosition = pos
        $('.circleSelect').removeClass('active')
        $('.inSelct h3').css('color', '#6a6a6a')
        switch (pos) {
            case "0":
                $('#checkT').css('color', 'dodgerblue')
                $('#check').addClass('active')
                break
            case  "1":
                $('#managerT').css('color', 'dodgerblue')
                $('#manager').addClass('active')
                break
            case  "-1":
                $('#unCheckT').css('color', 'dodgerblue')
                $('#unCheck').addClass('active')
                break
        }
    }

    function updateSelect2() {
        $('.circleSelect2').removeClass('active')
        $('.inSelct2 h3').css('color', '#6a6a6a')
        $('#havePayText').hide()
        $('#notPayText').hide()
        if (isPay) {
            $('#havePayText').show()
            $('#havePay').css('color', 'dodgerblue')
            $('#havePay').addClass('active')
        } else {
            $('#notPayText').show()
            $('#unPay').css('color', 'dodgerblue')
            $('#unPay').addClass('active')
        }
    }
    var singlePermisson=0
    function updateSelect3(){
        $('.circleSelect3').removeClass('active')
        $('.inSelct3 h3').css('color','#6a6a6a')

        if(singlePermisson===0){
            $('#single').css('color','dodgerblue')
            $('#single').addClass('active')
        }else{
            $('#fullYear').css('color','dodgerblue')
            $('#fullYear').addClass('active')
        }
    }
    lifeCycle.onCreateView = function () {
        return `
    <div class="topBar">
      <img src="../img/btn_back_normal.png" style="width: 40px;height: 40px;" onmousedown="glitter.goBack();">
    <h3 style="color: white;flex: auto;font-size: 16px;text-align: center;margin-right: 40px;"> ${(gBundle.showFiniacial) ? '繳費狀況查詢':'個人檔案'}</h3>
    </div>
    <h3 style="background-color:white;margin:0;font-size:16px;height: 50px;display: flex;align-items: center;justify-content: center;width: 100%;color: #1a4064;font-weight: 600;border-bottom: 1px solid whitesmoke;">
    ${gBundle.data.pick}
</h3>
<div style="height: calc(100% - 120px);overflow-y: scroll;width: 100%;" >
         <div class="content" style="position: relative;">
         <div style="position: absolute;z-index: -1;width: 100%;height: 100%;"></div>
<img class="head" id="head" onclick="addImageView()" src="${gBundle.data.head}">
 <h3 class="smallTitle">會員身份</h3>
<input id="memberAuth" value="${['個人會員','終身會員','自然會員','團體會員','非會員'][parseInt(userData.singlePermisson,10)]}" style="color: darkcyan;" readonly>
<h3 class="smallTitle">繳費狀況</h3>
<input id="memberPay" value="${['未繳費 / 待繳金額:'+userData.notPay+'元','已繳費 / 已繳金額:'+userData.payMoney+'元','無需繳費'][parseInt(userData.isPay,10)]}" style="color: ${['red','orangered','darkcyan'][parseInt(userData.isPay,10)]};" readonly>
${(gBundle.showFiniacial) ? ``:`<div style="display:flex;width: 100%; align-items: center;justify-content: center;margin-top:30px;height: 40px;" >
         <div class="inSelct" onclick="">
            <div class="circleSelect active" id="unCheck" onclick=""></div>
   <h3 style="color: #6a6a6a;font-size: 16px;margin-left: 5px;" id="unCheckT">未認證</h3>
</div>
  <div class="inSelct" onclick="">
            <div class="circleSelect" id="check"></div>
   <h3 style="color: #6a6a6a;font-size: 16px;margin-left: 5px;" id="checkT">已認證</h3>
</div>
 <div class="inSelct" onclick="">
            <div class="circleSelect" id="manager"></div>
   <h3 style="color: #6a6a6a;font-size: 16px;margin-left: 5px;" id="managerT">管理員</h3>
</div>
         </div>`}
         ${(gBundle.showFiniacial) ? ``:`
<h3 class="smallTitle">電子信箱</h3>
<input id="email" value="${gBundle.data.email}" placeholder="請輸入你的信箱" readonly>

<h3 class="smallTitle">姓名</h3>
<input id="pick" value="${gBundle.data.pick}" placeholder="請輸入您的全名" readonly>
<h3 class="smallTitle">性別</h3>
<div class="flexSelect">
<div class="selectItem">
 <div id="male" class="checkBox ${(gBundle.data.gender === '0') ? 'check' : ''}" onclick=""></div>
<span>男性</span>
</div>
<div class="selectItem">
 <div id="female" class="checkBox ${(gBundle.data.gender === '1') ? 'check' : ''}" onclick=""></div>
<span>女性</span>
</div>
</div>
<h3 class="smallTitle">生日</h3>
<input id="birthday" style="background-color:white;width:calc(100% - 40px);min-height: 40px;" type="date"  data-date-format="yyyy-mm-dd" data-provide="datepicker" value="${userData.birthday.substring(0, 10)}" readonly>
<h3 class="smallTitle">畢業科系</h3>
<input id="gurade" value="${gBundle.data.gurade}" placeholder="請輸入您的畢業科系" readonly>
<h3 class="smallTitle">會員編號</h3>
<input id="userCode" value="${gBundle.data.userCode}" placeholder="請輸入您的會員編號" readonly>
<h3 class="smallTitle">電話</h3>
<input id="phone" value="${gBundle.data.phone}" type="number" placeholder="請輸入您的電話" readonly>
<h3 class="smallTitle">地址</h3>
<input id="address" value="${gBundle.data.address}" placeholder="請輸入您的地址" readonly>
<div style="flex: auto;">
</div>`}

</div>
</div>

    `
    }
    var gender = gBundle.data.gender

    function postInfo() {
        var model = {}
        model.userID = gBundle.data.userID
        model.userCode = $('#userCode').val()
        model.account = gBundle.data.account
        model.password = gBundle.data.password
        model.isPay = ((isPay) ? 1 : 0)
        model.head = $('#head').attr('src')
        model.pick = $('#pick').val()
        model.gurade = $('#gurade').val()
        if ($('#birthday').val().indexOf("00:00:00") === -1) {
            model.birthday = `${$('#birthday').val()} 00:00:00`
        } else {
            model.birthday = `${$('#birthday').val()}`
        }
        model.manager = selectPosition
        model.gender = gender
        model.socialId = gBundle.data.socialId
        model.email = $('#email').val()
        model.phone = $('#phone').val()
        model.address = $('#address').val()
        if ((model.pick === '')) {
            glitter.openDiaLog('dialog/Dia_Info.html', 'Dia_Info', false, true, "請輸入你的名稱", function () {
            })
            return
        } else if (model.account === '') {
            glitter.openDiaLog('dialog/Dia_Info.html', 'Dia_Info', false, true, "帳號不得為空", function () {
            })
            return
        } else if ($('#gurade').val() === '') {
            glitter.openDiaLog('dialog/Dia_Info.html', 'Dia_Info', false, true, "請輸入您的畢業科系", function () {
            })
            return
        } else if ($('#birthday').val() === '') {
            glitter.openDiaLog('dialog/Dia_Info.html', 'Dia_Info', false, true, "請輸入您的生日", function () {
            })
            return
        } else if ($('#gender').val() === '') {
            glitter.openDiaLog('dialog/Dia_Info.html', 'Dia_Info', false, true, "請選擇您的性別", function () {
            })
            return
        } else if ($('#phone').val() === '') {
            glitter.openDiaLog('dialog/Dia_Info.html', 'Dia_Info', false, true, "請輸入您的電話", function () {
            })
            return
        } else if ($('#address').val() === '') {
            glitter.openDiaLog('dialog/Dia_Info.html', 'Dia_Info', false, true, "請輸入您的地址", function () {
            })
            return
        } else if (model.email === '') {
            glitter.openDiaLog('dialog/Dia_Info.html', 'Dia_Info', false, true, "請輸入您的信箱", function () {
            })
            return
        }
        glitter.share.dataLoading(true)
        glitter.publicBeans.publicLogic.changeInfo(model, function (response) {
            glitter.share.dataLoading(false)
            if (response === undefined) {
                glitter.share.internetError()
            } else {
                if (response.result) {
                    glitter.goBack()
                    glitter.copyObj(glitter.publicBeans.publicLogic.customDefine.user_data, model)
                    glitter.share.hint("更改資料成功")
                } else {
                    glitter.share.hint("更改資料失敗")
                }
            }
        })
    }
</script>
</body>
</html>